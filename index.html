<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NB Automated | Operations Portal</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- LOGIN OVERLAY -->
    <div id="loginOverlay" class="modal-overlay">
        <div class="login-box">
            <img src="assets/logo.png" alt="NB AUTOMATED" class="login-logo" onerror="this.style.display='none'">
            <h2>Staff Access</h2>
            <p>Enter 4-digit PIN</p>
            <input type="password" id="pinInput" placeholder="PIN" maxlength="4" inputmode="numeric">
            <button id="loginBtn">Unlock Portal</button>
            <p id="loginError" class="error-msg hidden"></p>
        </div>
    </div>

    <!-- MAIN APP CONTENT -->
    <div id="mainContent" class="app-card hidden">
        <header>
            <div class="logo-container">
                <img src="assets/logo.png" alt="NB AUTOMATED" class="company-logo" onerror="this.style.display='none'">
            </div>
            <h1>Operations Portal</h1>
            <p id="staffWelcome">System by The Oracle</p>
        </header>

        <nav class="view-tabs">
            <button id="viewEntryBtn" class="tab-btn active-tab">Record Entry</button>
            <button id="viewDashBtn" class="tab-btn">Data Dashboard</button>
        </nav>

        <!-- RECORD ENTRY VIEW -->
        <form id="opForm">
            <div class="input-group">
                <label>Transaction Type</label>
                <select id="saleType" required>
                    <option value="Retail">Retail Sale</option>
                    <option value="Reseller">Reseller Sale</option>
                    <option value="Expense">Business Expense</option>
                </select>
            </div>
            <div class="input-group" id="catGroup">
                <label>Category</label>
                <select id="category" required disabled><option value="">Syncing...</option></select>
            </div>
            <div class="input-group">
                <div class="label-row">
                    <label id="productLabel">Product / Item</label>
                    <span id="stockBadge" class="stock-badge hidden"></span>
                </div>
                <select id="product" required disabled><option value="">Select Category First</option></select>
                <input type="text" id="manualInput" class="hidden" placeholder="Reason for expense">
            </div>
            <div class="input-group">
                <label id="qtyLabel">Quantity</label>
                <input type="number" id="qty" min="1" placeholder="Enter Qty" required>
            </div>
            <button type="submit" id="submitBtn">Log Transaction</button>
        </form>

        <!-- DATA DASHBOARD VIEW -->
        <div id="dashboardView" class="hidden">
            <div class="filter-controls">
                <div class="mode-toggle">
                    <label><input type="radio" name="viewMode" value="monthly" checked> Monthly</label>
                    <label><input type="radio" name="viewMode" value="yearly"> Yearly</label>
                </div>
                <select id="monthSelector" class="selector-ui"></select>
                <select id="yearSelector" class="selector-ui hidden"></select>
            </div>

            <div class="stats-grid">
                <div class="stat-card highlight">
                    <span class="stat-label">Net Profit</span>
                    <span id="displayNet" class="stat-value">â‚¦0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Gross Profit</span>
                    <span id="displayGross" class="stat-value">â‚¦0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Revenue</span>
                    <span id="displayRevenue" class="stat-value">â‚¦0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Expenses</span>
                    <span id="displayExpenses" class="stat-value">â‚¦0</span>
                </div>
            </div>

            <div class="valuation-card">
                <h3>ðŸ“¦ Current Inventory Valuation</h3>
                <div class="val-grid">
                    <div>
                        <span class="stat-label">Asset Cost</span>
                        <span id="valCost" class="stat-value small">â‚¦0</span>
                    </div>
                    <div>
                        <span class="stat-label">Retail Val</span>
                        <span id="valRetail" class="stat-value small">â‚¦0</span>
                    </div>
                    <div>
                        <span class="stat-label">Reseller Val</span>
                        <span id="valReseller" class="stat-value small">â‚¦0</span>
                    </div>
                </div>
            </div>

            <div class="charts-container">
                <div class="chart-box"><canvas id="revenueTrendChart"></canvas></div>
                <div class="chart-box"><canvas id="typeDistChart"></canvas></div>
            </div>

            <div id="leaderboardContent" class="stock-list"></div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
